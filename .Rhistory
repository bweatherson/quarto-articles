#       str_sub(
#         graph_auth,
#         start = str_locate_all(graph_auth, " ")[[1]][2] + 1,
#         end = str_locate_all(graph_auth, " ")[[1]][3] -1
#       ),
#       " and ",
#       str_sub(
#         graph_auth,
#         start = str_locate_all(graph_auth, " ")[[1]][6] + 1,
#         end = str_length(graph_auth)
#       )
#     ),
#   spaces_in_auth == 5 ~
#     paste0(
#       str_sub(
#         graph_auth,
#         start = str_locate_all(graph_auth, " ")[[1]][1] + 1,
#         end = str_locate_all(graph_auth, " ")[[1]][2] -1
#       ),
#       " and ",
#       str_sub(
#         graph_auth,
#         start = str_locate_all(graph_auth, " ")[[1]][5] + 1,
#         end = str_length(graph_auth)
#       )
#     ),
#   spaces_in_auth == 4 ~
#     paste0(
#       str_sub(
#         graph_auth,
#         start = str_locate_all(graph_auth, " ")[[1]][1] + 1,
#         end = str_locate_all(graph_auth, " ")[[1]][2] -1
#       ),
#       " and ",
#       str_sub(
#         graph_auth,
#         start = str_locate_all(graph_auth, " ")[[1]][4] + 1,
#         end = str_length(graph_auth)
#       )
#     ),
#   spaces_in_auth == 3 ~
#     paste0(
#       str_sub(
#         graph_auth,
#         start = str_locate_all(graph_auth, " ")[[1]][1] + 1,
#         end = str_locate_all(graph_auth, " ")[[1]][2] - 2
#       ),
#       " et al"
#     ),
#   graph_auth == 'Gaile Pohlhaus Jr.' ~ 'Pohlhaus Jr.',
#   spaces_in_auth == 2 ~
#     str_sub(
#       graph_auth,
#       start = str_locate_all(graph_auth, " ")[[1]][2] + 1,
#       end = str_length(graph_auth)
#     ),
#   TRUE ~  str_sub(
#     graph_auth,
#     start = str_locate_all(graph_auth, " ")[[1]][1] + 1,
#     end = str_length(graph_auth)
#   )
# )) |>
mutate(short_auth = case_when(
art_title == "Is Conceivability A Guide To Possibility" ~ "Yablo, Conceivability",
art_title == "Paradox Without Self-Reference" ~ "Yablo, Paradox",
art_title == "What Is Equality .2. Equality Of Resources" ~ "Dworkin Pt. 2",
art_title == "What Is Equality .1. Equality Of Welfare" ~ "Dworkin Pt. 1",
art_title == "In Defense Of Proper Functions" ~ "Millikan, Proper Function",
art_title == "Biosemantics" ~ "Millikan, Biosemantics",
art_title == "Concepts Of Supervenience" ~ "Kim, Concepts",
art_title == "Epiphenomenal And Supervenient Causation" ~ "Kim, Epiphenomenal",
art_title == "Probabilities Of Conditionals And Conditional Probabilities" ~ "Lewis, Probabilities",
art_title == "Paradoxes Of Time Travel" ~ "Lewis, Time Travel",
art_title == "Attitudes De-Dicto And De-Se" ~ "Lewis, De Se",
art_title == "Counterfactual Dependence And Times Arrow" ~ "Lewis, Time\'s Arrow",
art_title == "Scorekeeping In A Language Game" ~ "Lewis, Scorekeeping",
art_title == "Functions As Selected Effects: The Conceptual Analysts Defense" ~ "Neander, Selected",
art_title == "The Teleological Notion Of Function" ~ "Neander, Teleological",
short_auth == "Rabinowicz and Ronnow-Rasmussen" ~ "R and R-R",
short_auth == "Inwagen" ~ "van Inwagen",
short_auth == "Fraassen" ~ "van Fraassen",
TRUE ~ short_auth
)) |>
left_join(select(philo_bib, id, longcite), by = c("old" = "id")) |>
rowwise() |>
mutate(end_of_longcite = str_sub(longcite, str_length(longcite)-35, str_length(longcite)-5)) |>
mutate(end_of_longcite = str_replace_all(end_of_longcite, "[a-z]", "")) |>
mutate(end_of_longcite = str_replace_all(end_of_longcite, "[A-Z]", "")) |>
mutate(end_of_longcite = str_replace_all(end_of_longcite, "[,.?]", "")) |>
mutate(end_of_longcite = str_replace_all(end_of_longcite, "^:", "")) |>
mutate(end_of_longcite = str_squish(end_of_longcite)) |>
mutate(end_of_longcite = str_replace_all(end_of_longcite, "^:", "")) |>
mutate(end_of_longcite = str_replace_all(end_of_longcite, "^\\)", "")) |>
mutate(end_of_longcite = str_replace_all(end_of_longcite, "^\\&", "")) |>
mutate(end_of_longcite = str_replace_all(end_of_longcite, "-$", "")) |>
mutate(end_of_longcite = str_replace_all(end_of_longcite, " 1$", "")) |>
mutate(end_of_longcite = str_replace_all(end_of_longcite, " 2$", "")) |>
mutate(end_of_longcite = str_replace_all(end_of_longcite, " 4$", "")) |>
mutate(end_of_longcite = str_replace_all(end_of_longcite, " 17$", "")) |>
mutate(end_of_longcite = str_squish(end_of_longcite)) |>
mutate(end_of_longcite = case_when(
art_title == "Disagreement, Question-Begging And Epistemic Self-Criticism" ~ "11 (6): 1-22",
art_title == "Grounding Explanations" ~ "13 (7): 1-26",
art_title == "The Possibility Of Physicalism" ~ "111 (9-10): 557-592",
art_title == "Unified Foundations For Essence And Ground" ~ "1 (2): 296-311",
old == "WOS:000366669500008" ~ "58 (7-8): 828-874",
TRUE ~ end_of_longcite)
) |>
select(end_of_longcite, everything()) |>
ungroup()
rolling_averages <- citation_tibble |>
filter(old %in% main_bib$old) |>
group_by(old, new_year) |>
tally(name = "cites") |>
ungroup() |>
complete(old, new_year, fill = list(cites = 0)) |>
filter(new_year <= 2022) |>
ungroup() |>
group_by(old) |>
arrange(old, new_year) |>
mutate(rolling = slider::slide_dbl(cites, mean, .before = 4)) |>
left_join(main_bib, by = "old") |>
select(old, old_year, new_year, cites, rolling, graph_cite, short_auth)
main_bib <- main_bib |>
mutate(full_citation = paste0(graph_cite, " _", journal, "_ ", end_of_longcite,"."))
#| label: graph-code
#| cache: false
rolling_spaghetti_graph <- function(x){
ggplot(filter(rolling_averages, old %in% filter(
main_bib, old_year == x
)$old,
new_year >= x), aes(x = new_year, y = rolling, color = short_auth)) +
geom_line() +
theme(legend.position="bottom",
legend.title = element_blank()) +
guides(color = guide_legend(nrow = 3, byrow = TRUE)) +
labs(x = element_blank(),
y = element_blank(),
title =  paste0("Widely cited articles from ", x),
subtitle = "Rolling five year average of citations in 100 philosophy journals") +
scale_x_continuous(breaks = 198:202 * 10, minor_breaks = 396:404*5) +
ylim(0, max(20, max(
filter(rolling_averages, old %in% filter(
main_bib, old_year == x
)$old,
new_year >= x)$rolling
)))
}
rolling_facet_graph <- function(x){
temp <- filter(rolling_averages, old_year == x, new_year >= x) |> ungroup() |> arrange(graph_cite)
#  temp$graph_cite <- factor(temp$graph_cite, levels = temp$graph_cite, labels = temp$short_auth)
background <- temp |> rename(backer = short_auth)
ggplot(temp, aes(x = new_year, y = rolling, color = short_auth)) +
geom_line(data = background, aes(x = new_year, y = rolling, group = backer), color = "grey85", alpha = 0.6) +
geom_line(size = 1, alpha = 1) +
theme(legend.position="none") +
labs(x = element_blank(),
y = element_blank()) +
scale_x_continuous(breaks = 198:202 * 10, minor_breaks = 396:404*5) +
facet_wrap(vars(short_auth)) +
ylim(0, max(20, max(
filter(rolling_averages, old %in% filter(
main_bib, old_year == x
)$old,
new_year >= x)$rolling
)))
}
#| label: tbl-list-of-journals
#| tbl-cap: The journals included in this study
require(knitr)
temp <- philo_bib |>
group_by(journal) |>
summarise(Articles = n(), `First Year` = min(year), `Most Recent Year` = max(year)) |>
rename(Journal = journal)
kable(temp)
#| label: fig-number-of-articles-by-year
#| fig-cap: "Number of articles in the study each year"
philo_bib |>
group_by(year) |>
filter(year >= 1976, year <= 2022) |>
tally() |>
ggplot(aes(x = year, y = n)) +
geom_line() +
labs(x = element_blank(),
y = element_blank(),
title = "Number of Articles in Database Each Year") +
scale_x_continuous(breaks = 197:202 * 10, minor_breaks = 393:404*5)
#| label: fig-number-of-citations-by-year
#| fig-cap: "Number of citations to articles in the study each year"
citation_tibble |>
group_by(new_year) |>
filter(new_year >= 1976, new_year <= 2022) |>
tally() |>
ggplot(aes(x = new_year, y = n)) +
geom_line() +
theme(legend.position="bottom",
legend.title = element_blank(),
legend.direction = "vertical") +
labs(x = element_blank(),
y = element_blank(),
title = "Number of Citations in Database Each Year") +
scale_x_continuous(breaks = 197:202 * 10, minor_breaks = 393:404*5)
#| label: fig-average-of-citations-by-year
#| fig-cap: "Average number of citations per available article in each each year"
# Burp
article_years_summary <- article_years |>
ungroup() |>
group_by(year) |>
tally(name = "yearly_articles") |>
mutate(cumulative_articles = cumsum(yearly_articles))
mean_citations <- citation_tibble |>
group_by(new_year) |>
tally(name = "yearly_citations") |>
left_join(article_years_summary, by = c("new_year" = "year")) |>
mutate(mean_citations = yearly_citations/cumulative_articles) |>
filter(new_year <= 2022)
ggplot(mean_citations, aes(x = new_year, y = mean_citations)) +
geom_line() +
theme(legend.position="bottom",
legend.title = element_blank(),
legend.direction = "vertical") +
labs(x = element_blank(),
y = element_blank(),
title = "Average number of citations articles get each year",
subtitle = "Number of citations in a year divided by articles published up to that year") +
scale_x_continuous(breaks = 197:202 * 10, minor_breaks = 393:404*5)
#| label: tbl-journals-in-main-bib
#| tbl-cap: Which journals the 360 articles appeared in.
kable(
main_bib |>
group_by(journal) |>
tally(name = "Articles") |>
arrange(-Articles) |>
rename(Journal = journal)
)
#| label: tbl-recent-journals-in-main-bib
#| tbl-cap: Which journals the most recent 90 articles appeared in.
kable(
main_bib |>
filter(old_year >= 2006) |>
group_by(journal) |>
tally(name = "Articles") |>
arrange(-Articles) |>
rename(Journal = journal)
)
#| label: this-cannot-work
# Note: Run this fragment before rendering document
setwd("~/Documents/quarto-articles/posts/citations-raw-data")
the_code <- c()
for (year in 1976:2015){
# Widely Cited Articles subsection
the_code <- c(the_code,
"\n## ",
year,
" {#sec-s",
year,
"}\n\n### Widely Cited Articles {-}\n\n")
temp <- filter(main_bib, old_year == year) |> rename(Articles = full_citation) |> select(Articles)
for (i in 1:9){
the_code <- c(the_code, i, ". ", temp$Articles[i], "\n")
}
# Citation Count Section
the_code <- c(the_code,
"\n### Citation Count {-#sec-count-",
year,
"}\n\n",
"\`\`\`{r}\n",
"#| label: tbl-citation-count-",
year,
"\n",
"#| tbl-cap: Citation count for widely cited articles from ",
year,
".",
"\n\n",
"year_cites <- rank_table_generator(",year,")\n",
"kable(select(year_cites, Article, All = Citations, Early = \`Early Citations\`, Late = \`Late Citations\`))\n",
"\`\`\`",
"\n\n")
# Citation Rank Section
the_code <- c(the_code,
"\n### Citation Rank {-#sec-rank-",
year,
"}\n\n",
"\`\`\`{r}\n",
"#| label: tbl-citation-rank-",
year,
"\n",
"#| tbl-cap: Citation rank for widely cited articles from ",
year,
".",
"\n\n",
"kable(select(year_cites, Article, Overall = \`Citation Rank\`, Early = \`Early Rank\`, Late = \`Late Rank\`))\n",
"\`\`\`",
"\n\n")
# Spaghetti Graph
the_code <- c(the_code,
"\n### Citation Trends {-#sec-trends-",
year,
"}\n\n",
"\`\`\`{r}\n",
"#| label: fig-citation-spaghetti-",
year,
"\n",
"#| fig-cap: Rolling five year average of citation frequency for widely cited articles from ",
year,
".",
"\n",
"#| cache: TRUE",
"\n\n",
"rolling_spaghetti_graph(",
year,
")\n",
"\`\`\`",
"\n\n"
)
# Facet Graph
the_code <- c(the_code,
"\`\`\`{r}\n",
"#| label: fig-citation-facet-",
year,
"\n",
"#| fig-cap: Faceted version of @fig-citation-spaghetti-",
year,
".",
"\n",
"#| cache: TRUE",
"\n\n",
"rolling_facet_graph(",
year,
")\n",
"\`\`\`",
"\n\n\\newpage\n\n"
)
}
cat(the_code, sep = "", file = "_section-2.qmd")
View(philo_cite)
# Find articles that cite articles which cite each of the 360
cite_second <- c()
for (i in 1:nrow(main_bib)){
initial_article <- main_bib$old[i]
first_round <- filter(philo_cite, refs == initial_article)$id
second_round <- filter(philo_cite, refs %in% first_round)$id
cite_second <- bind_rows(cite_second,
tibble(
old = rep(initial_article, each=length(second_round)),
new = second_round
))
}
View(cite_second)
View(article_years)
cite_second <- cite_second |>
left_join(article_years, by("new" = "id")) |>
rename(new_year = year)
cite_second <- cite_second |>
left_join(article_years, by = c("new" = "id")) |>
rename(new_year = year)
cite_second <- cite_second |>
left_join(article_years, by = c("new" = "id")) |>
rename(new_year = year) |>
left_join(main_bib, by = c("old"))
cite_second <- c()
for (i in 1:nrow(main_bib)){
initial_article <- main_bib$old[i]
first_round <- filter(philo_cite, refs == initial_article)$id
second_round <- filter(philo_cite, refs %in% first_round)$id
cite_second <- bind_rows(cite_second,
tibble(
old = rep(initial_article, each=length(second_round)),
new = second_round
))
}
cite_second_expanded <- cite_second |>
left_join(article_years, by = c("new" = "id")) |>
rename(new_year = year) |>
left_join(main_bib, by = c("old"))
View(cite_second_expanded)
cite_second_expanded <- cite_second |>
left_join(article_years, by = c("new" = "id")) |>
rename(new_year = year) |>
left_join(main_bib, by = c("old")) |>
select(old, old_year, graph_cite, new, new_year)
cite_second_summary <- cite_second_expanded |>
group_by(old_year, graph_cite, new_year) |>
tally()
View(cite_second_summary)
cite_second_overall <- cite_second_expanded |>
filter(new_year >= 2003, new_year <= 2022) |>
group_by(new_year) |>
tally()
View(cite_second_overall)
cite_second_overall <- cite_second_expanded |>
filter(new_year >= 2003, new_year <= 2022) |>
group_by(new_year) |>
tally(name = "all_seconds")
cite_second_summary <- cite_second_expanded |>
group_by(old_year, graph_cite, new_year) |>
filter(new_year >= 2003, new_year <= 2022) |>
tally(name = "second_cites") |>
left_join(cite_second_overall, by = "new_year") |>
mutate(proportion = second_cites/all_seconds)
View(cite_second_summary)
year_2021_cites <- citation_tibble |>
filter(new_year == 2021, old %in% main_bib$old) |>
group_by(old) |>
tally() |>
left_join(main_bib, by = "old") |>
arrange(-n)
year_2021_cites <- citation_tibble |>
filter(new_year == 2021, old %in% main_bib$old) |>
group_by(old) |>
tally(name = "cites_2021") |>
left_join(main_bib, by = "old") |>
arrange(-cites_2021)
View(year_2021_cites)
year_2021_cites <- citation_tibble |>
filter(new_year == 2021, old %in% main_bib$old) |>
group_by(old) |>
tally(name = "cites_2021") |>
left_join(main_bib, by = "old") |>
arrange(-cites_2021) |>
select(cites_2021, graph_cite)
year_2021_cites <- citation_tibble |>
filter(new_year == 2021, old %in% main_bib$old) |>
group_by(old) |>
tally(name = "cites_2021") |>
left_join(main_bib, by = "old") |>
arrange(-cites_2021) |>
select(cites_2021, graph_cite) |>
left_join(select(
cite_second_summary, graph_cite, second_cites), by = "graph_cite") |>
mutate(second_ratio = second_cites / cites_2021)
View(year_2021_cites)
year_2021_cites <- citation_tibble |>
ungroup() |>
filter(new_year == 2021, old %in% main_bib$old) |>
group_by(old) |>
tally(name = "cites_2021") |>
left_join(main_bib, by = "old") |>
arrange(-cites_2021) |>
select(cites_2021, graph_cite) |>
left_join(select(
cite_second_summary, graph_cite, second_cites), by = "graph_cite") |>
mutate(second_ratio = second_cites / cites_2021)
year_2021_cites <- citation_tibble |>
ungroup() |>
filter(new_year == 2021, old %in% main_bib$old) |>
group_by(old) |>
tally(name = "cites_2021") |>
left_join(main_bib, by = "old") |>
arrange(-cites_2021) |>
select(cites_2021, graph_cite) |>
left_join(select(
cite_second_summary, graph_cite, second_cites) |> ungroup(), by = "graph_cite") |>
mutate(second_ratio = second_cites / cites_2021)
year_2021_cites <- citation_tibble |>
ungroup() |>
filter(new_year == 2021, old %in% main_bib$old) |>
group_by(old) |>
tally(name = "cites_2021")
year_2021_cites <- citation_tibble |>
ungroup() |>
filter(new_year == 2021, old %in% main_bib$old) |>
group_by(old) |>
tally(name = "cites_2021") |>
left_join(main_bib, by = "old")
year_2021_cites <- citation_tibble |>
ungroup() |>
filter(new_year == 2021, old %in% main_bib$old) |>
group_by(old) |>
tally(name = "cites_2021") |>
left_join(main_bib, by = "old") |>
arrange(-cites_2021)
year_2021_cites <- citation_tibble |>
ungroup() |>
filter(new_year == 2021, old %in% main_bib$old) |>
group_by(old) |>
tally(name = "cites_2021") |>
left_join(main_bib, by = "old") |>
arrange(-cites_2021) |>
select(cites_2021, graph_cite)
year_2021_cites <- citation_tibble |>
ungroup() |>
filter(new_year == 2021, old %in% main_bib$old) |>
group_by(old) |>
tally(name = "cites_2021") |>
left_join(main_bib, by = "old") |>
arrange(-cites_2021) |>
select(cites_2021, graph_cite) |>
left_join(select(
cite_second_summary, graph_cite, second_cites) |> ungroup(), by = "graph_cite")
year_2021_cites <- citation_tibble |>
ungroup() |>
filter(new_year == 2021, old %in% main_bib$old) |>
group_by(old) |>
tally(name = "cites_2021") |>
left_join(main_bib, by = "old") |>
arrange(-cites_2021) |>
select(cites_2021, graph_cite) |>
left_join(select(
cite_second_summary |> ungroup(), graph_cite, second_cites) , by = "graph_cite") |>
mutate(second_ratio = second_cites / cites_2021)
year_2021_cites <- citation_tibble |>
ungroup() |>
filter(new_year == 2021, old %in% main_bib$old) |>
group_by(old) |>
tally(name = "cites_2021") |>
left_join(main_bib, by = "old") |>
arrange(-cites_2021) |>
select(cites_2021, graph_cite) |>
left_join(select(
cite_second_summary |> ungroup() |> filter(new_year == 2021), graph_cite, second_cites) , by = "graph_cite") |>
mutate(second_ratio = second_cites / cites_2021)
